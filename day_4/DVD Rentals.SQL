/* 
Calculate total rental revenue per film.
Scenario: The finance team needs to know the total revenue generated by each film.
Task: Calculate the total rental revenue for each film.
*/
SELECT 
    f.title, 
    SUM(p.amount) AS "Revenue Generated"
FROM film f
LEFT JOIN inventory i ON f.film_id = i.film_id
LEFT JOIN rental r ON i.inventory_id = r.inventory_id
LEFT JOIN payment p ON r.rental_id = p.rental_id
GROUP BY f.film_id, f.title
HAVING SUM(p.amount) >= 0
ORDER BY "Revenue Generated" DESC;



/* 
Find actors who have appeared in more than 10 films.
Scenario: The casting director wants to identify actors who are highly experienced.
Task: List actors along with the number of films they have acted in, where the count is more than 10.
*/
SELECT 
    CONCAT(a.first_name, ' ', a.last_name) AS "Actor Name",
    COUNT(f.film_id) AS "Number of Movies Played"
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
GROUP BY a.actor_id, a.first_name, a.last_name
HAVING COUNT(f.film_id) > 10
ORDER BY "Number of Movies Played" DESC;
